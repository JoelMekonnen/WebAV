import sys
import os
from math import log
import numpy as np
import pandas as pd
import scipy as sp
from PIL import Image
import matplotlib.pyplot as plt
from keras_preprocessing.image import load_img, img_to_array, ImageDataGenerator
from keras import models
from django.conf import settings

def avPredict(fileName):
    label_list = ['Benign', 'Malware']
    myModel = models.load_model(r'malware-vs-benign.h5')
    myImage = load_img(fileName, target_size=(64, 64))
    #preproccess
    img_array = img_to_array(myImage)
    myImage = img_array.reshape((1, 64, 64, 3))
    myPrediction = myModel.predict(myImage)
    real_pred = np.argmax(myPrediction, axis=1)
    res = label_list[real_pred[0]]
    return res
